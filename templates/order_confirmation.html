{% extends 'base.html' %}

{% block title %}Commande confirmée | DOUKA KM{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow border-0">
                <div class="card-body p-4 text-center">
                    <div class="mb-4">
                        <div class="check-circle">
                            <i class="fas fa-check fa-3x text-white"></i>
                        </div>
                    </div>
                    <h2 class="mb-3">Merci pour votre commande!</h2>
                    
                    {% if orders_count > 1 %}
                        <p class="lead mb-4">Vos {{ orders_count }} commandes ont été complétées avec succès et seront traitées par chaque boutique séparément.</p>
                        
                        <div class="alert alert-info mb-4">
                            <h5><i class="fas fa-info-circle me-2"></i> Commandes créées :</h5>
                            {% for order_number in order_numbers %}
                            <p class="mb-1"><strong>{{ order_number }}</strong></p>
                            {% endfor %}
                            <hr>
                            <p class="mb-2"><small>Chaque boutique traitera sa commande indépendamment. Vous pourrez suivre le statut de chaque commande séparément.</small></p>
                            
                            {% if session.get('promo_code_used') %}
                            <div class="text-success">
                                <i class="fas fa-tag me-1"></i>
                                <small><strong>Code promo appliqué :</strong> Votre réduction a été appliquée à l'une de vos commandes pour éviter toute duplication.</small>
                            </div>
                            {% endif %}
                        </div>
                    {% else %}
                        <p class="lead mb-4">Votre commande a été complétée avec succès et sera traitée dès que possible.</p>
                        
                        {% if order_numbers and order_numbers|length > 0 %}
                        <div class="alert alert-info mb-4">
                            <p class="mb-0">Numéro de commande: <strong>{{ order_numbers[0] }}</strong></p>
                            <p class="mb-0">Vous recevrez bientôt un email avec tous les détails de votre commande.</p>
                        </div>
                        {% endif %}
                    {% endif %}
                    
                    <div class="d-flex justify-content-center mt-4 gap-3">
                        <a href="{{ url_for('orders', new_order=true) }}" class="btn btn-primary">
                            <i class="fas fa-box me-2"></i> Voir mes commandes
                        </a>
                        <a href="{{ url_for('products') }}" class="btn btn-outline-primary">
                            <i class="fas fa-shopping-bag me-2"></i> Continuer mes achats
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Jouer une animation de confetti pour célébrer la commande
    if (typeof confetti !== 'undefined') {
        confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 }
        });
    }
});
</script>

<style>
.check-circle {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background-color: #28a745;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1rem;
    animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0% {
        transform: scale(0.9);
        box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.7);
    }
    
    70% {
        transform: scale(1);
        box-shadow: 0 0 0 10px rgba(40, 167, 69, 0);
    }
    
    100% {
        transform: scale(0.9);
        box-shadow: 0 0 0 0 rgba(40, 167, 69, 0);
    }
}
</style>
{% endblock %}
